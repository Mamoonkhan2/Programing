<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../style/setting.css" />
    <title>Setting</title>
  </head>
  <body>
    <div class="main">
      <button id="show-info12">Show info</button>

      <div class="info" style="display: none">
        <br />

        <label>name</label>
        <input type="text" placeholder="enter the name" id="nameTextField" />
        <button id="ename">Edit</button><br />

        <label>age</label>
        <input type="text" placeholder="enter the name" id="ageTextField" />
        <button id="eage">Edit</button> <br/>
        <label>password</label>
        <input type="text" placeholder="enter the name" id="passTextField" />
        <button id="epass">Edit</button><br />

        <label>Image Path</label>
        <input type="text" placeholder="enter the name" id="imgTextField" />
        <button id="eimg">Edit</button><br />
        <button id="submit-Sec-1">submit</button>
      </div>
    </div>
    <div class="result" style="display: none"></div>
  </body>
  <script type="module">
    // loading Data
    import { std } from "../class.js";

    let STORAGE_KEY = "StudentFormData";
    let CurrentUserKey = "CurrentUser";
    let UserInfoObj = JSON.parse(localStorage.getItem(CurrentUserKey)) || {};
    let LogDataInfo = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
    // Dom Element

    //button feild
    let shwoInfoBtn = document.querySelector("#show-info12");
    let textinputbtn = document.querySelector("#ename");
    let ageinputbtn = document.querySelector("#eage");
    let passinputbtn = document.querySelector("#epass");
    let Imginputbtn = document.querySelector("#eimg");
    let submitbtn = document.querySelector("#submit-Sec-1");
    let result = document.querySelector(".result");

    //txt filed of Dom element

    let nameValue = document.querySelector("#nameTextField");
    let ageValue = document.querySelector("#ageTextField");
    let passValue = document.querySelector("#passTextField");
    let imgSrcValue = document.querySelector("#imgTextField");
    //by defalut the input feild is disabled

    nameValue.disabled = true;
    ageValue.disabled = true;
    passValue.disabled = true;
    imgSrcValue.disabled = true;

    // will check to edit the field
    console.log("hello wordl");

    // click event

    textinputbtn.addEventListener("click", EditBtn(nameValue));
    ageinputbtn.addEventListener("click", EditBtn(ageValue));
    passinputbtn.addEventListener("click", EditBtn(passValue));
    Imginputbtn.addEventListener("click", EditBtn(imgSrcValue));
    shwoInfoBtn.addEventListener("click", Click);
    submitbtn.addEventListener("click", Submit);

    // function
    function Switchcondition(nameValue) {
      switch (nameValue) {
        case true:
          return false;

          break;

        case false:
          return true;

          break;

        default:
          break;
      }
    }
    function EditBtn(value) {
      return function () {
        value.disabled = Switchcondition(value.disabled);
      };
    }
    function Click() {
      LoadDefalut();
      console.log("hello world");

      let displayValue = document.querySelector(".info").style.display;
      switch (displayValue) {
        case "none":
          document.querySelector(".info").style.display = "block";
          break;
        case "block":
          document.querySelector(".info").style.display = "none";
          break;
        default:
          break;
      }
    }
    function Check(input) {
      if (!input.value) {
        console.log("not a value");
        return false;
      }
      return true;
    }
    function ClearEveything() {
      nameValue.disabled = true;
      ageValue.disabled = true;
      passValue.disabled = true;
      imgSrcValue.disabled = true;
      nameValue.value = "";
      ageValue.value = "";
      passValue.value = "";
      imgSrcValue.value = "";
    }
    function SaveData() {
      localStorage.setItem("CurrentUser", JSON.stringify(UserInfoObj));
    }
    
    function AssignValueToInputFeild(name,age,pass,imgsrc) {
        nameValue.value =   name;
        ageValue.value =    age;
        passValue.value =   pass;
        imgSrcValue.value = imgsrc;
    }
    function DisabledAllEdit() {
        textinputbtn.disabled = true;
        ageinputbtn.disabled = true;
        passinputbtn.disabled = true;
        Imginputbtn.disabled = true;
        shwoInfoBtn.disabled = true;
        
    }

    function LoadDefalut() {
      if (Object.keys(UserInfoObj).length == 0) {
        UserInfoObj = {
          name: "please enter name by logining",
          age: "plese enter age by longing ",
          password: "please enter password by logining",
          src: "please enter src by logining",
        };
        AssignValueToInputFeild(UserInfoObj.name,UserInfoObj.age,UserInfoObj.password,UserInfoObj.src)
        DisabledAllEdit()
        submitbtn.style.display = "none";
        
        setTimeout(() => {
          result.style.display = "block";

          let setime = 10000; // 10sec
          let pakege = new std(setime);
          let div = pakege.timoutFun();

          result.appendChild(div);

          setTimeout(() => {
            window.location.href =
              "http://127.0.0.1:5501/javascript/project/Projects/StudentForm/Form/Login.html";
          }, setime+2000);

          document.querySelector(".main").style.display = "none";
        }, 1000);
      } else {
        AssignValueToInputFeild(UserInfoObj.name,UserInfoObj.age,UserInfoObj.password,UserInfoObj.src)
      }
    }
    function AssignValueToUserObj(name,age,pass,src) {
        UserInfoObj.name = name;
        UserInfoObj.age  = age;
        UserInfoObj.password = pass
        UserInfoObj.src  = src
    }
    function Submit(e) {
      e.preventDefault();
      AssignValueToUserObj(nameValue.value,ageValue.value,passValue.value,imgSrcValue.value)
      SaveData();
      ClearEveything();
      LoadDefalut();
    }
  </script>
</html>

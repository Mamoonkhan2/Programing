<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Digital Examination Management System</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f5f5f5;
    }
    .card {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    .card h2 {
      margin: 0;
      font-size: 24px;
      color: #333;
    }
    .card p {
      margin: 10px 0;
      color: #555;
    }
    .btn {
      display: inline-block;
      padding: 8px 12px;
      margin-right: 10px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      color: #fff;
    }
    .like-btn {
      background-color: #28a745;
    }
    .edit-btn {
      background-color: #007bff;
    }
    ul{
    display: flex;
    background-color: bisque;
    
}
.navigation{
    margin-left: 50px;
} 
li{
        list-style-type: none;
}
#noteCard {
  max-width: 720px;
  margin: 40px auto;
  padding: 25px;
  background: #ffffff;
  border-radius: 14px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
}

/* VIEW MODE */
#viewForm {
  position: relative;
}

#viewForm h2 {
  text-align: center;
  color: #2c3e50;
  margin-bottom: 15px;
}

#viewForm p {
  margin: 10px 0;
  font-size: 15px;
  color: #444;
}

#viewForm strong {
  color: #000;
}

/* CONTENT AREA */
#content {
  display: block;
  margin-top: 12px;
  padding: 15px;
  background: #f4f6f8;
  border-radius: 10px;
  line-height: 1.6;
  font-size: 14px;
}

/* EDIT BUTTON */
.edit-btn {
  position: absolute;
  right: 0;
  top: 0;
  background: #0d6efd;
  color: #fff;
  border: none;
  padding: 8px 16px;
  border-radius: 8px;
  cursor: pointer;
  transition: 0.3s ease;
}

.edit-btn:hover {
  background: #084298;
}

/* EDIT MODE */
#editForm {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

#editForm input,
#editForm textarea {
  width: 100%;
  padding: 12px;
  border-radius: 10px;
  border: 1px solid #ccc;
  font-size: 14px;
  resize: vertical;
}

#editForm textarea {
  min-height: 90px;
}

#editForm input:focus,
#editForm textarea:focus {
  outline: none;
  border-color: #0d6efd;
  box-shadow: 0 0 0 2px rgba(13, 110, 253, 0.2);
}

/* ACTION BUTTONS */
#saveBtn {
  background: #198754;
  color: #fff;
  border: none;
  padding: 12px;
  border-radius: 10px;
  cursor: pointer;
}

#cancelBtn {
  background: #dc3545;
  color: #fff;
  border: none;
  padding: 12px;
  border-radius: 10px;
  cursor: pointer;
}

#saveBtn:hover {
  background: #146c43;
}

#cancelBtn:hover {
  background: #b02a37;
}

/* RESPONSIVE */
@media (max-width: 600px) {
  #noteCard {
    margin: 15px;
    padding: 20px;
  }

  .edit-btn {
    padding: 6px 12px;
  }
}
  </style>
</head>
<body>
    <header>
        <ul>
            <li class="navigation"><a href="./home.html">Home</a></li>
            <li class="navigation"><a href="./upload.html">Upload Notes</a></li>
            <li class="navigation"><a href="./detail.html">Detail</a></li>
            <li class="navigation"><a href="./setting.html">Settings</a></li>
            <li class="navigation"><a href="">About</a></li>
        </ul>
    </header>
    <div id="noteCard">

  <!-- VIEW MODE -->
  <form class="edit" id="viewForm">
    <button type="button" class="btn edit-btn" id="editBtn">Edit</button>

    <h2 id="title"></h2>
    <p><strong>Name:</strong> <span id="name"></span></p>
    <p><strong>ID:</strong> <span id="noteId"></span></p>

    <p>
      <strong>Description:</strong>
      <span id="innerDescription"></span>
    </p>

    <h3 style="text-align:center;"><strong>Content</strong></h3>
    <p><span id="content"></span></p>
    <button class="btn like-btn" onclick="checkForLike()">Like <span id="likess"></span></button>
  </form>

  <!-- EDIT MODE -->
  <form id="editForm" style="display:none;">
    <input type="text" id="editTitle" placeholder="Title" />
    <input type="text" id="editName" placeholder="Name" />

    <textarea id="editDescription" placeholder="Description"></textarea>
    <textarea id="editContent" placeholder="Content"></textarea>

    <button type="button" id="saveBtn">Save</button>
    <button type="button" id="cancelBtn">Cancel</button>
  </form>

</div>
    <!-- Edit button on top -->

</body>
<script>
// Keys
let STORAGE_KEY = "StudentFormData"
let CurrentUserKey = 'CurrentUser';
let NOTES_KEY  = "NOTESDATA"
const CURRENT_KEY = "CurrentNotes";
//loading Data
let userInfoObj = JSON.parse(localStorage.getItem('CurrentUser')) || [];
let logDataInfo = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
let notesDataObj   = JSON.parse(localStorage.getItem(NOTES_KEY)) || [];
let currentNotesObj = JSON.parse(localStorage.getItem(CURRENT_KEY)) || {};

let likeBtn = document.querySelector('.like-btn');
let cardDiv = document.querySelector(".datainfo");

const title = document.getElementById("title");
const name = document.getElementById("name");
const noteId = document.getElementById("noteId");
const innerDescription = document.getElementById("innerDescription");
const content = document.getElementById("content");

// EDIT DOM
const viewForm = document.getElementById("viewForm");
const editForm = document.getElementById("editForm");

const editBtn = document.getElementById("editBtn");
const saveBtn = document.getElementById("saveBtn");
const cancelBtn = document.getElementById("cancelBtn");

const editTitle = document.getElementById("editTitle");
const editName = document.getElementById("editName");
const editDescription = document.getElementById("editDescription");
const editContent = document.getElementById("editContent");

// RENDER VIEW
function renderView() {
  title.textContent = currentNotesObj.title;
  name.textContent = currentNotesObj.name;
  noteId.textContent = currentNotesObj.id;
  innerDescription.textContent = currentNotesObj.description;
  content.textContent = currentNotesObj.contantInput;
}
renderView();

// EDIT BUTTON
editBtn.addEventListener("click", () => {
  editTitle.value = currentNotesObj.title;
  editName.value = currentNotesObj.name;
  editDescription.value = currentNotesObj.description;
  editContent.value = currentNotesObj.contantInput;

  viewForm.style.display = "none";
  editForm.style.display = "block";
});

// SAVE BUTTON
saveBtn.addEventListener("click", () => {
  currentNotesObj.title = editTitle.value;
  currentNotesObj.name = editName.value;
  currentNotesObj.description = editDescription.value;
  currentNotesObj.contantInput = editContent.value;

  renderView();

  editForm.style.display = "none";
  viewForm.style.display = "block";
});
saveBtn.addEventListener('click',(event)=>{
  
  let editNote = {
    name:currentNotesObj.name,
    title:editTitle.value,
    id:currentNotesObj.id,
    key:currentNotesObj.key,
    description:editDescription.value,
    contantInput:editContent.value,
    likedBy:currentNotesObj.likedBy,
    like:currentNotesObj.like,
  }
  currentNotesObj={...editNote};
  const index = notesDataObj.findIndex(item => item.key == currentNotesObj.key)
  notesDataObj[index] = currentNotesObj;
  console.log(notesDataObj[index]);
  SaveDataC(currentNotesObj);
  SaveData(notesDataObj);

})
// CANCEL BUTTON
cancelBtn.addEventListener("click", () => {
  editForm.style.display = "none";
  viewForm.style.display = "block";
});
const likeEl = document.querySelector("#likess");
likeEl.innerHTML = currentNotesObj.like;
let isLike = true;
function checkForLike() {
  event.preventDefault()
  const userKey = currentNotesObj.key;
  const noteId = currentNotesObj.id;

  let note = notesDataObj.find(n => n.id === noteId);
  if (!note) return;

  note.likedBy = note.likedBy || [];

  const hasLiked = note.likedBy.includes(userKey);

  if (!hasLiked) {
    // ðŸ‘ LIKE
    note.like++;
    note.likedBy.push(userKey);
  } else {
    // ðŸ‘Ž UNLIKE
    note.like--;
    note.likedBy = note.likedBy.filter(k => k !== userKey);
  }

  // Sync current note
  currentNotesObj.like = note.like;
  currentNotesObj.likedBy = note.likedBy;

  SaveDataC(currentNotesObj);
  SaveData(notesDataObj);

  likeEl.innerHTML = note.like;
}
function SaveDataC(obj){
    localStorage.setItem(CURRENT_KEY,JSON.stringify(obj))
}
function SaveData(obj){
    localStorage.setItem(NOTES_KEY,JSON.stringify(obj))
}
</script>
</html>
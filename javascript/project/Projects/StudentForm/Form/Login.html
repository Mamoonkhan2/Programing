<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../style/login.css">
    <title>Login</title>
</head>
<body>
    <div class="contaner">
        <div class="login">
         
            <form>
                <label>Username</label><br>
                <input class="input" type="text" id="name" placeholder="Enter your username"><br>
                <label>Password</label><br>
                <input class="input" type="password" id="Password" placeholder="enter your Password"><br>
                <!-- <label >ImgPath</label><br>
                <input type="text" id="src" placeholder="give the path of img"><br><br> -->
                <button class="Submit">Submit</button><br>
            </form>
        </div><br>
        <div class="signup">
            <button class="Submit"><a href="../Form/StudentForm.html">signup</a></button>
        </div><br>        
    </div>

</body>
<script>
    let uName = document.querySelector("#name")
    let uPassword = document.querySelector("#Password")
    let submit = document.querySelector(".Submit")
    
    // loading data 
    let STORAGE_KEY = "StudentFormData"
    let AllUserData = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
    // function
    function CheckUp() {
        if(!uName.value || !uPassword.value )
        {
            return false;
        }
        return true   
    }
    function ClearEverything() {
        uName.value = ''
        // uAge.value = ''
        uPassword.value = ''
    }
    function UpdateData(e){
        e.preventDefault()
        
        if (!CheckUp()) return alert("empty field");    
        
        console.log("hello from bug");
        let user = AllUserData.find(
        u => u.name === uName.value && u.password === uPassword.value
        );

        if (!user) {
        alert("Invalid username or password");
        return;
        }

        alert("login successful");

        let loginUser = {
        key: user.key,
        name: user.name,
        age: user.age,
        src: user.src,
        notes: user.notes
        };

        // ðŸ”¥ STORE CURRENT USER (ONE PLACE ONLY)
        localStorage.setItem('CurrentUser', JSON.stringify(loginUser));

        setTimeout(() => {
        ClearEverything();
        window.location.href = "../Home/home.html";
        }, 500);
    }
    // event listener
  function Switchcondition(nameValue) {
        switch (nameValue.type) {
        case "text":
            return "password";
            
            break;
    
        case "password":
            return "text";
            
            break;
    
        default:
            break;
    }

}
    submit.addEventListener('click',UpdateData);
    uPassword.addEventListener('click',(e)=>{
        uPassword.type = Switchcondition(uPassword);
        
    })
</script>
</html>
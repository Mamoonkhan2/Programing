<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
</head>
<body>
    <div class="contaner">
        <div class="login">
         
            <form>
                <label>Username</label><br>
                <input type="text" id="name" placeholder="Enter your username"><br>
                <label>Password</label><br>
                <input type="text" id="Password" placeholder="enter your Password"><br>
                <!-- <label >ImgPath</label><br>
                <input type="text" id="src" placeholder="give the path of img"><br><br> -->
                <button id="submit">Submit</button><br>
            </form>
        </div><br>
        <div class="signup">
            <button><a href="../Form/StudentForm.html">signup</a></button>
        </div><br>        
    </div>

</body>
<script>
    let uName = document.querySelector("#name")
    let uPassword = document.querySelector("#Password")
    let submit = document.querySelector("#submit")
    // loading data 
    let STORAGE_KEY = "StudentFormData"
    let CurrentUser = JSON.parse(localStorage.getItem('CurrentUser')) || [];
    let AllUserData = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
    // function
    function CheckUp() {
        if(!uName.value || !uPassword.value )
        {
            return false;
        }
        return true   
    }
    function ClearEverything() {
        uName.value = ''
        // uAge.value = ''
        uPassword.value = ''
    }
    function UpdateData(e){
        e.preventDefault()
        let check = CheckUp();
        if(!check) return alert("empty field");
        let checkName = AllUserData.some(userName => userName.name == uName.value.trim());
        let checkPass = AllUserData.some(userPass => (userPass.password == uPassword.value));
        
        console.log(uName.value);
        console.log(uPassword.value);
        console.log('asdfasdfas',checkName);
        console.log('asdf',checkPass);
        
        
        
        if(checkName && checkPass){
            CurrentUser = AllUserData.filter(username => (username.name === uName.value));
            alert("login succses ful");
            setTimeout(()=>{
                ClearEverything()
                localStorage.setItem('CurrentUser',JSON.stringify(CurrentUser));
                window.location.href = "http://127.0.0.1:5500/StudentForm/Home/home.html"
            },500)
        }
        else if(!checkName){
            alert("name Not found");
            ClearEverything();
        }
        else {
            alert("password not found");
            uPassword.value = '';
        }
    }
    // event listener
    submit.addEventListener('click',UpdateData);

</script>
</html>
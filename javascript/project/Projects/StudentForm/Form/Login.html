<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../style/login.css">
    <title>Login</title>
</head>
<body>
    <div class="contaner">
        <div class="login">
         
            <form>
                <label>Username</label><br>
                <input class="input" type="text" id="name" placeholder="Enter your username"><br>
                <label>Password</label><br>
                <input class="input" type="password" id="Password" placeholder="enter your Password"><br>
                <!-- <label >ImgPath</label><br>
                <input type="text" id="src" placeholder="give the path of img"><br><br> -->
                <button class="Submit">Submit</button><br>
            </form>
        </div><br>
        <div class="signup">
            <button class="Submit"><a href="../Form/StudentForm.html">signup</a></button>
        </div><br>        
    </div>

</body>
<script>
    let uName = document.querySelector("#name")
    let uPassword = document.querySelector("#Password")
    let submit = document.querySelector(".Submit")
    // loading data 
    let STORAGE_KEY = "StudentFormData"
    let CurrentUser = JSON.parse(localStorage.getItem('CurrentUser')) || {};
    let AllUserData = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
    // function
    function CheckUp() {
        if(!uName.value || !uPassword.value )
        {
            return false;
        }
        return true   
    }
    function ClearEverything() {
        uName.value = ''
        // uAge.value = ''
        uPassword.value = ''
    }
    function UpdateData(e){
        e.preventDefault()
        let check = CheckUp();
        if(!check) return alert("empty field");
        let checkName = AllUserData.some(userName =>userName.name == uName.value)
        let checkPass = AllUserData.some(userPass =>userPass.password == uPassword.value)
        
        console.log(uName.value);
        console.log(uPassword.value);
        console.log('asdfasdfas',checkName);
        console.log('asdf',checkPass);
        
        
        
        if(checkName && checkPass){
            CurrentUser = AllUserData.filter(username => (username.name === uName.value));
            alert("login succses ful");
            console.log(CurrentUser[0].key)
            setTimeout(()=>{
                ClearEverything()
                let loginuser = {
                    key:CurrentUser[0].key,
                    name:CurrentUser[0].name,
                    password:CurrentUser[0].password,
                    age:CurrentUser[0].age,
                    src:CurrentUser[0].src,
                    notes:CurrentUser[0].notes,
                }
                localStorage.setItem('CurrentUser',JSON.stringify(loginuser));
                window.location.href = "../Home/home.html"
            },500)
        }
        else if(!checkName){
            alert("name Not found");
            ClearEverything();
        }
        else {
            alert("password not found");
            uPassword.value = '';
        }
    }
    // event listener
  function Switchcondition(nameValue) {
        switch (nameValue.type) {
        case "text":
            return "password";
            
            break;
    
        case "password":
            return "text";
            
            break;
    
        default:
            break;
    }

}
    submit.addEventListener('click',UpdateData);
    uPassword.addEventListener('click',(e)=>{
        uPassword.type = Switchcondition(uPassword);
        
    })
</script>
</html>